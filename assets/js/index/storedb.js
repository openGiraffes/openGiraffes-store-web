class StoreDatabaseAPI{constructor(){this.db={}}loadData(){var e=this;return new Promise((function(s,r){var n=new Worker("assets/js/index/workers/store-worker.js");n.onmessage=function(r){n.terminate(),e.db=r.data,s(r.data)},n.onerror=function(e){n.terminate(),r(e)},n.postMessage(null)}))}getAppsByCategory(e){if(e in this.db.categories)return this.db.apps.categorical[e];throw new TypeError('Category "'+e+'" does not exist!')}sortApps(e,s){var r=this;return new Promise((function(n,t){var a=new Worker("assets/js/index/workers/sort-worker.js");switch(a.onmessage=function(e){a.terminate(),n(e.data.apps)},a.onerror=function(e){a.terminate(),t(e)},s){case"alphabetical":case"categorical":a.postMessage({apps:e,sort:s});break;case"popularity":a.postMessage({apps:e,sort:s,downloadCounts:r.db.apps.downloadCounts});break;default:console.warn("[StoreDb] Unable to sort, returning unsorted apps."),n(e)}}))}dlCountApp(e){return new Promise((function(s,r){var n=new Worker("assets/js/index/workers/ratings-worker.js");n.onmessage=function(e){n.terminate(),e.data.success?s(e.data):r(e.data)},n.onerror=function(e){n.terminate(),r({success:!1,response:{error:e}})},n.postMessage({command:"count",args:{slug:e}})}))}getAppRatings(e){return new Promise((function(s,r){var n=new Worker("assets/js/index/workers/ratings-worker.js");n.onmessage=function(e){n.terminate(),e.data.success?s(e.data):r(e.data)},n.onerror=function(e){n.terminate(),r({success:!1,response:{error:e}})},n.postMessage({command:"get",args:{appid:e}})}))}loginToRatingsAccount(e,s){return new Promise((function(r,n){var t=new Worker("assets/js/index/workers/ratings-worker.js");t.onmessage=function(e){t.terminate(),e.data.success?r(e.data):n(e.data)},t.onerror=function(e){t.terminate(),n({success:!1,response:{error:e}})},t.postMessage({command:"login",args:{username:e,logintoken:s}})}))}createRatingsAccount(e,s){return new Promise((function(r,n){var t=new Worker("assets/js/index/workers/ratings-worker.js");t.onmessage=function(e){t.terminate(),e.data.success?r(e.data):n(e.data)},t.onerror=function(e){t.terminate(),n({success:!1,response:{error:e}})},t.postMessage({command:"create",args:{username:e,logintoken:s}})}))}addNewRating(e,s,r,n,t){return new Promise((function(a,o){var i=new Worker("assets/js/index/workers/ratings-worker.js");i.onmessage=function(e){i.terminate(),e.data.success?a(e.data):o(e.data)},i.onerror=function(e){i.terminate(),o({success:!1,response:{error:e}})},i.postMessage({command:"add",args:{username:e,logintoken:s,appid:r,points:n,description:t}})}))}}