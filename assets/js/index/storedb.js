class StoreDatabaseAPI{constructor(){this.db={}}loadData(){const e=this;return new Promise((function(s,r){const n=new Worker("assets/js/index/workers/store-worker.js");n.onmessage=function(r){n.terminate(),e.db=r.data,s(r.data)},n.onerror=function(e){n.terminate(),r(e)},n.postMessage(null)}))}getAppsByCategory(e){if(e in this.db.categories)return this.db.apps.categorical[e];throw new TypeError('Category "'+e+'" does not exist!')}sortApps(e,s){const r=this;return new Promise((function(n,t){const o=new Worker("assets/js/index/workers/sort-worker.js");switch(o.onmessage=function(e){o.terminate(),n(e.data.apps)},o.onerror=function(e){o.terminate(),t(e)},s){case"alphabetical":case"categorical":o.postMessage({apps:e,sort:s});break;case"popularity":o.postMessage({apps:e,sort:s,downloadCounts:r.db.apps.downloadCounts});break;default:console.warn("[StoreDb] Unable to sort, returning unsorted apps."),n(e)}}))}dlCountApp(e){return new Promise((function(s,r){const n=new Worker("assets/js/index/workers/ratings-worker.js");n.onmessage=function(e){n.terminate(),e.data.success?s(e.data):r(e.data)},n.onerror=function(e){n.terminate(),r({success:!1,response:{error:e}})},n.postMessage({command:"count",args:{slug:e}})}))}getAppRatings(e){return new Promise((function(s,r){const n=new Worker("assets/js/index/workers/ratings-worker.js");n.onmessage=function(e){n.terminate(),e.data.success?s(e.data):r(e.data)},n.onerror=function(e){n.terminate(),r({success:!1,response:{error:e}})},n.postMessage({command:"get",args:{appid:e}})}))}loginToRatingsAccount(e,s){return new Promise((function(r,n){const t=new Worker("assets/js/index/workers/ratings-worker.js");t.onmessage=function(e){t.terminate(),e.data.success?r(e.data):n(e.data)},t.onerror=function(e){t.terminate(),n({success:!1,response:{error:e}})},t.postMessage({command:"login",args:{username:e,logintoken:s}})}))}createRatingsAccount(e,s){return new Promise((function(r,n){const t=new Worker("assets/js/index/workers/ratings-worker.js");t.onmessage=function(e){t.terminate(),e.data.success?r(e.data):n(e.data)},t.onerror=function(e){t.terminate(),n({success:!1,response:{error:e}})},t.postMessage({command:"create",args:{username:e,logintoken:s}})}))}addNewRating(e,s,r,n,t){return new Promise((function(o,a){const i=new Worker("assets/js/index/workers/ratings-worker.js");i.onmessage=function(e){i.terminate(),e.data.success?o(e.data):a(e.data)},i.onerror=function(e){i.terminate(),a({success:!1,response:{error:e}})},i.postMessage({command:"add",args:{username:e,logintoken:s,appid:r,points:n,description:t}})}))}}